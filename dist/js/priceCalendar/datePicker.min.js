!function(t){function a(a,e){this.config={showHoliday:!0,showVacation:!0,monthNum:7,vacation:["2017-01-01","2017-01-02","2017-01-27","2017-01-28","2017-01-29","2017-01-30","2017-1-31","2017-02-01","2017-02-02","2017-04-02","2017-04-03","2017-04-04","2017-04-29","2017-04-30","2017-05-01","2017-05-28","2017-05-29","2017-05-30","2017-10-01","2017-10-02","2017-10-03","2017-10-04","2017-10-05","2017-10-06","2017-10-07","2017-10-08","2017-12-30","2017-12-31","2018-01-01","2018-02-15","2018-02-16","2018-02-17","2018-02-18","2018-02-19","2018-02-20","2018-02-21"],holiday:[{"2017-01-01":"元旦"},{"2017-01-20":"小年"},{"2017-01-27":"除夕"},{"2017-01-28":"春节"},{"2017-02-11":"元宵"},{"2017-03-08":"妇女节"},{"2017-04-02":"清明"},{"2017-05-01":"劳动节"},{"2017-05-14":"母亲节"},{"2017-05-30":"端午"},{"2017-07-01":"建党节"},{"2017-08-01":"建军节"},{"2017-09-10":"教师节"},{"2017-10-01":"国庆节"},{"2018-01-01":"元旦"},{"2018-02-08":"小年"},{"2018-02-15":"除夕"},{"2018-02-16":"春节"}],showToday:!0},this.config=t.extend(this.config,e),this.wrapper=t(a),this.init()}a.prototype.getMonthData=function(t,a){var e=[];if(!t||!a){var i=new Date;t=i.getFullYear(),a=i.getMonth()+1}var n=new Date(t,a-1,1),o=n.getDay();0===o&&(o=7),t=n.getFullYear(),a=n.getMonth()+1;for(var r=new Date(t,a-1,0),d=r.getDate(),l=o-1,s=new Date(t,a,0),c=s.getDate(),h=0;h<42;h++){var v=h+1-l,p=v,f=a;v<=0?(f=a-1,p=d+v):v>c&&(f=a+1,p-=c),0===f&&(f=12),13===f&&(f=1),e.push({month:f,date:v,showDate:p})}return{year:t,month:a,days:e}},a.prototype.buildUi=function(t,a){var e=this.getMonthData(t,a);console.log(e);for(var i='<div class="datepicker"><div class="picker-header clearfix"><span class="current-month">'+e.year+"年"+e.month+'月</span></div><div class="picker-body"><div><ul>',n=0;n<e.days.length;n++){var o=e.days[n],a=o.month,r=o.showDate;if(a<10&&(a="0"+a),r<10&&(r="0"+r),o.month==e.month&&(new Date).getDate()>o.showDate&&(new Date).getMonth()+1==e.month)i+='<li class="noPick" data-date="'+e.year+"-"+a+"-"+r+'"><em>'+o.showDate+"</em><i></i></li>";else{if(o.month>e.month)break;o.month<e.month?i+='<li class="noPick" data-date="'+e.year+"-"+a+"-"+r+'"></li>':i+='<li data-date="'+e.year+"-"+a+"-"+r+'"><em>'+o.showDate+"</em><i></i></li>"}}return i+="</ul></div></div></div>"},a.prototype.bindEvent=function(){t(".datePicker-wrapper").on("click",".close",function(){t(".datePicker-wrapper").hide()})},a.prototype.init=function(){for(var a="",e=(new Date).getMonth(),i=0;i<this.config.monthNum;i++){var n=(new Date).getFullYear();e++,a+=this.buildUi(n,e)}var o=t('<div class="datePicker-wrapper"><div class="week-top"><div class="close">返回</div><div>选择日期</div></div><ul class="week-header"><li>一</li><li>二</li><li>三</li><li>四</li><li>五</li><li>六</li><li>日</li></ul></div>');o.append(a),this.wrapper.append(o);var r=t(".datePicker-wrapper").find("li:not(.noPick)"),d=new Date,l=d.getMonth()+1;l=l>=10?l:"0"+l;var s=d.getDate();s=s>=10?s:"0"+s;var c=d.getFullYear()+"-"+l+"-"+s,h=this;r.each(function(){var a=t(this);h.config.showVacation&&h.config.vacation.forEach(function(t){t==a.data("date")&&a.append('<span class="vacation">休</span>')}),h.config.showHoliday&&h.config.holiday.forEach(function(t){for(var e in t)e==a.data("date")&&a.find("em").html(t[e])}),h.config.showToday&&a.data("date")==c&&(a.find("em").html("今天"),a.addClass("today"))}),this.bindEvent()},t.fn.extend({datePicker:function(t){return new a(this,t)}})}(jQuery);