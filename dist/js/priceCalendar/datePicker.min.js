!function(a){function t(t,e){this.config={showHoliday:!0,showVacation:!0,monthNum:7,vacation:["2017-01-01","2017-01-02","2017-01-27","2017-01-28","2017-01-29","2017-01-30","2017-1-31","2017-02-01","2017-02-02","2017-04-02","2017-04-03","2017-04-04","2017-04-29","2017-04-30","2017-05-01","2017-05-28","2017-05-29","2017-05-30","2017-10-01","2017-10-02","2017-10-03","2017-10-04","2017-10-05","2017-10-06","2017-10-07","2017-10-08","2017-12-30","2017-12-31","2018-01-01","2018-02-15","2018-02-16","2018-02-17","2018-02-18","2018-02-19","2018-02-20","2018-02-21"],holiday:[{"2017-01-01":"元旦"},{"2017-01-20":"小年"},{"2017-01-27":"除夕"},{"2017-01-28":"春节"},{"2017-02-11":"元宵"},{"2017-03-08":"妇女节"},{"2017-04-02":"清明"},{"2017-05-01":"劳动节"},{"2017-05-14":"母亲节"},{"2017-05-30":"端午"},{"2017-07-01":"建党节"},{"2017-08-01":"建军节"},{"2017-09-10":"教师节"},{"2017-10-01":"国庆节"},{"2018-01-01":"元旦"},{"2018-02-08":"小年"},{"2018-02-15":"除夕"},{"2018-02-16":"春节"}],showToday:!0},this.config=a.extend(this.config,e),this.wrapper=a(t),this.init()}t.prototype.getMonthData=function(a,t){var e=[];if(!a||!t){var i=new Date;a=i.getFullYear(),t=i.getMonth()+1}var n=new Date(a,t-1,1),o=n.getDay();0===o&&(o=7),a=n.getFullYear(),t=n.getMonth()+1;for(var r=new Date(a,t-1,0),l=r.getDate(),d=o-1,s=new Date(a,t,0),h=s.getDate(),c=0;c<42;c++){var v=c+1-d,f=v,p=t;v<=0?(p=t-1,f=l+v):v>h&&(p=t+1,f-=h),0===p&&(p=12),13===p&&(p=1),e.push({month:p,date:v,showDate:f})}return{year:a,month:t,days:e}},t.prototype.buildUi=function(a,t){var e=this.getMonthData(a,t);console.log(e);for(var i='<div class="datepicker"><div class="picker-header clearfix"><span class="current-month">'+e.year+"年"+e.month+'月</span></div><div class="picker-body"><div><ul>',n=0;n<e.days.length;n++){var o=e.days[n],t=o.month,r=o.showDate;if(t<10&&(t="0"+t),r<10&&(r="0"+r),e.year==(new Date).getFullYear()&&o.month==e.month&&(new Date).getDate()>o.showDate&&(new Date).getMonth()+1==e.month)i+='<li class="noPick" data-date="'+e.year+"-"+t+"-"+r+'"><em>'+o.showDate+"</em><i></i></li>";else if(1==e.month){if(2==o.month)break;12==o.month?i+='<li class="noPick" data-date="'+e.year+"-"+t+"-"+r+'"></li>':i+='<li data-date="'+e.year+"-"+t+"-"+r+'"><em>'+o.showDate+"</em><i></i></li>"}else{if(o.month>e.month)break;o.month<e.month?i+='<li class="noPick" data-date="'+e.year+"-"+t+"-"+r+'"></li>':i+='<li data-date="'+e.year+"-"+t+"-"+r+'"><em>'+o.showDate+"</em><i></i></li>"}}return i+="</ul></div></div></div>"},t.prototype.bindEvent=function(){a(".datePicker-wrapper").on("click",".close",function(){a(".datePicker-wrapper").hide()})},t.prototype.init=function(){for(var t="",e=(new Date).getMonth(),i=0;i<this.config.monthNum;i++){var n=(new Date).getFullYear();e++,t+=this.buildUi(n,e)}var o=a('<div class="datePicker-wrapper"><div class="week-top"><div class="close">返回</div><div>选择日期</div></div><ul class="week-header"><li>一</li><li>二</li><li>三</li><li>四</li><li>五</li><li>六</li><li>日</li></ul></div>');o.append(t),this.wrapper.append(o);var r=a(".datePicker-wrapper").find("li:not(.noPick)"),l=new Date,d=l.getMonth()+1;d=d>=10?d:"0"+d;var s=l.getDate();s=s>=10?s:"0"+s;var h=l.getFullYear()+"-"+d+"-"+s,c=this;r.each(function(){var t=a(this);c.config.showVacation&&c.config.vacation.forEach(function(a){a==t.data("date")&&t.append('<span class="vacation">休</span>')}),c.config.showHoliday&&c.config.holiday.forEach(function(a){for(var e in a)e==t.data("date")&&t.find("em").html(a[e])}),c.config.showToday&&t.data("date")==h&&(t.find("em").html("今天"),t.addClass("today"))}),this.bindEvent()},a.fn.extend({datePicker:function(a){return new t(this,a)}})}(jQuery);